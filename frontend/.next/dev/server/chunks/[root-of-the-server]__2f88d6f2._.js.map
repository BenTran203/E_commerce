{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///G:/Projects/e_com/E_commerce/frontend/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport type { NextAuthConfig } from \"next-auth\";\nimport GoogleProvider from \"next-auth/providers/google\";\nimport FacebookProvider from \"next-auth/providers/facebook\";\nimport TwitterProvider from \"next-auth/providers/twitter\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\n\nconst authOptions = {\n  providers: [\n    // Google OAuth\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\",\n      authorization: {\n        params: {\n          prompt: \"consent\",\n          access_type: \"offline\",\n          response_type: \"code\",\n        },\n      },\n    }),\n\n    // Facebook OAuth\n    FacebookProvider({\n      clientId: process.env.FACEBOOK_CLIENT_ID || \"\",\n      clientSecret: process.env.FACEBOOK_CLIENT_SECRET || \"\",\n    }),\n\n    // Twitter OAuth\n    TwitterProvider({\n      clientId: process.env.TWITTER_CLIENT_ID || \"\",\n      clientSecret: process.env.TWITTER_CLIENT_SECRET || \"\",\n    }),\n\n    // Credentials Provider (for email/password login)\n    CredentialsProvider({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          throw new Error(\"Email and password required\");\n        }\n\n        try {\n          // Call your backend API\n          const response = await fetch(\n            `${process.env.NEXT_PUBLIC_API_URL || \"http://localhost:3001/api\"}/auth/login`,\n            {\n              method: \"POST\",\n              headers: { \"Content-Type\": \"application/json\" },\n              body: JSON.stringify({\n                email: credentials.email,\n                password: credentials.password,\n              }),\n            },\n          );\n\n          const data = await response.json();\n\n          if (!response.ok) {\n            throw new Error(data.message || \"Login failed\");\n          }\n\n          // Return user object with token\n          return {\n            id: data.data.user.id,\n            email: data.data.user.email,\n            name: `${data.data.user.firstName} ${data.data.user.lastName}`,\n            accessToken: data.data.tokens.accessToken,\n            refreshToken: data.data.tokens.refreshToken,\n            user: data.data.user,\n          };\n        } catch (error: any) {\n          throw new Error(error.message || \"Authentication failed\");\n        }\n      },\n    }),\n  ],\n\n  callbacks: {\n    async signIn({ user, account, profile }) {\n      // Handle OAuth sign in\n      if (\n        account?.provider === \"google\" ||\n        account?.provider === \"facebook\" ||\n        account?.provider === \"twitter\"\n      ) {\n        try {\n          // Register or login user via your backend\n          const response = await fetch(\n            `${process.env.NEXT_PUBLIC_API_URL || \"http://localhost:3001/api\"}/auth/social-login`,\n            {\n              method: \"POST\",\n              headers: { \"Content-Type\": \"application/json\" },\n              body: JSON.stringify({\n                provider: account.provider,\n                providerId: account.providerAccountId,\n                email: user.email,\n                name: user.name,\n                image: user.image,\n              }),\n            },\n          );\n\n          if (!response.ok) {\n            console.error(\"Social login failed:\", await response.text());\n            return false;\n          }\n\n          const data = await response.json();\n\n          // Store tokens\n          if (typeof window !== \"undefined\") {\n            localStorage.setItem(\"auth_token\", data.data.tokens.accessToken);\n            localStorage.setItem(\"user\", JSON.stringify(data.data.user));\n          }\n\n          return true;\n        } catch (error) {\n          console.error(\"Social sign in error:\", error);\n          return false;\n        }\n      }\n\n      return true;\n    },\n\n    async jwt({ token, user, account }) {\n      // Add access_token and user to JWT token\n      if (user) {\n        token.accessToken = (user as any).accessToken;\n        token.refreshToken = (user as any).refreshToken;\n        token.user = (user as any).user;\n      }\n      return token;\n    },\n\n    async session({ session, token }) {\n      // Add token and user to session\n      if (token) {\n        (session as any).accessToken = token.accessToken as string;\n        (session as any).refreshToken = token.refreshToken as string;\n        (session as any).user = token.user;\n      }\n      return session;\n    },\n  },\n\n  pages: {\n    signIn: \"/auth/login\",\n    error: \"/auth/error\",\n  },\n\n  session: {\n    strategy: \"jwt\",\n  },\n\n  secret:\n    process.env.AUTH_SECRET ||\n    process.env.NEXTAUTH_SECRET ||\n    \"development-secret-please-change-in-production\",\n} satisfies NextAuthConfig;\n\nconst { handlers } = NextAuth(authOptions);\nexport const { GET, POST } = handlers;\n"],"names":[],"mappings":"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"}}]
}